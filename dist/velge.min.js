!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Velge=e()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module){var merge=_dereq_("./utils/merge"),ChoiceStore=_dereq_("./stores/ChoiceStore"),Wrapper=_dereq_("./components/Wrapper"),Velge=function(element,options){options=options||{},this.element=element,this.store=new ChoiceStore,this.wrapper=new Wrapper(element),this._preloadChoiceStore(options)};merge(Velge.prototype,{setup:function(){return this.render(),this},render:function(){var options={choices:this.store.choiceNames(),chosen:this.store.chosenNames()};this.wrapper.render(options)},addChoice:function(choice){this.store.addChoice(choice),this.render()},addChosen:function(choice){this.store.addChosen(choice),this.render()},_preloadChoiceStore:function(options){var choices=options.choices||[],chosens=options.chosens||[];choices.forEach(function(choice){this.store.addChoice(choice)},this),chosens.forEach(function(choice){this.store.addChosen(choice)},this)}}),module.exports=Velge},{"./components/Wrapper":5,"./stores/ChoiceStore":7,"./utils/merge":10}],2:[function(_dereq_,module){var emphasize=_dereq_("../utils/emphasize"),merge=_dereq_("../utils/merge"),emitter=_dereq_("../utils/emitter"),Dropdown=function(){this.element=document.createElement("ol")},SELECT_EVENT="select";merge(Dropdown.prototype,emitter,{render:function(choices,options){return choices=choices||[],options=options||{},this._updateClassNames(),this._clearItems(),this._renderItems(choices,options),this.element},open:function(){this.isOpen=!0,this.render()},close:function(){this.isOpen=!1,this.render()},toggle:function(){this.isOpen=!this.isOpen,this.render()},handleClickName:function(name){this.emit(SELECT_EVENT,name)},_updateClassNames:function(){var names=["velge-dropdown"];this.isOpen&&names.push("open"),this.element.className=names.join(" ")},_clearItems:function(){for(var child;child=this.element.firstChild;)this.element.removeChild(child)},_renderItems:function(choices,options){var highlight=options.highlight,emphasis=options.emphasis;choices.forEach(function(name){var li=document.createElement("li");name===highlight&&(li.className="highlighted"),li.innerHTML=emphasize(name,emphasis),li.addEventListener("click",this.handleClickName.bind(this,name)),this.element.appendChild(li)},this)}}),module.exports=Dropdown},{"../utils/emitter":8,"../utils/emphasize":9,"../utils/merge":10}],3:[function(_dereq_,module){var merge=_dereq_("../utils/merge"),emitter=_dereq_("../utils/emitter"),Input=function(){this.element=document.createElement("input")},keycodes={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,COMMA:188};merge(Input.prototype,emitter,{render:function(value){return this.element.type="text",this.element.attributes.autocomplete="off",this.element.placeholder="Placeholder",this.element.className="velge-input",value&&(this.element.value=value),this.element.addEventListener("blur",this.handleBlur.bind(this)),this.element.addEventListener("focus",this.handleFocus.bind(this)),this.element.addEventListener("keydown",this.handleKeydown.bind(this)),this.element},handleKeydown:function(event){switch(event.keyCode){case keycodes.ENTER:this._emitAdd();break;case keycodes.COMMA:this._emitAdd();break;case keycodes.LEFT:this._emitNavigate("left");break;case keycodes.UP:this._emitNavigate("up");break;case keycodes.RIGHT:this._emitNavigate("right");break;case keycodes.DOWN:this._emitNavigate("down");break;default:this._emitChange()}},handleBlur:function(){this.emit("blur")},handleFocus:function(){this.emit("focus")},_emitAdd:function(){var value=this.element.value;value&&""!==value&&(this.element.value="",this.emit("add",value))},_emitChange:function(){this.emit("change",this.element.value)},_emitNavigate:function(direction){this.emit("navigate",direction)}}),module.exports=Input},{"../utils/emitter":8,"../utils/merge":10}],4:[function(_dereq_,module){var merge=_dereq_("../utils/merge"),emitter=_dereq_("../utils/emitter"),List=function(){this.element=document.createElement("ul")},REMOVE_EVENT="remove";merge(List.prototype,emitter,{render:function(chosen,options){return options=options||{},chosen=chosen||[],this.element.className="velge-list",this._clearItems(),this._renderItems(chosen,options),this.element},handleClickRemove:function(name){this.emit(REMOVE_EVENT,name)},_clearItems:function(){for(var child;child=this.element.firstChild;)this.element.removeChild(child)},_renderItems:function(chosen,options){var highlight=options.highlight;chosen.forEach(function(name){var li=document.createElement("li"),span=document.createElement("span"),rem=document.createElement("span");name===highlight&&(li.className="highlighted"),span.className="name",span.textContent=name,rem.className="remove",rem.innerHTML="&times;",rem.addEventListener("click",this.handleClickRemove.bind(this,name)),li.appendChild(span),li.appendChild(rem),this.element.appendChild(li)},this)}}),module.exports=List},{"../utils/emitter":8,"../utils/merge":10}],5:[function(_dereq_,module){var merge=_dereq_("../utils/merge"),Dropdown=_dereq_("./Dropdown"),Input=_dereq_("./Input"),List=_dereq_("./List"),Wrapper=function(parent){this.parent=parent};merge(Wrapper.prototype,{render:function(options){return options=options||{},this._renderElement(),this._renderDropdown(options),this._renderInput(options),this._renderList(options),this.element},_renderElement:function(){this.element||(this.element=document.createElement("div"),this.element.className="velge",this.parent.appendChild(this.element))},_renderDropdown:function(options){var choices=options.choices;this.dropdown||(this.dropdown=new Dropdown,this.element.appendChild(this.dropdown.element)),this.dropdown.render(choices)},_renderInput:function(){this.input=new Input,this.element.appendChild(this.input.element),this.input.render()},_renderList:function(options){var chosen=options.chosen;this.list||(this.list=new List,this.element.appendChild(this.list.element)),this.list.render(chosen)}}),module.exports=Wrapper},{"../utils/merge":10,"./Dropdown":2,"./Input":3,"./List":4}],6:[function(_dereq_,module){module.exports=_dereq_("./Velge")},{"./Velge":1}],7:[function(_dereq_,module){var merge=_dereq_("../utils/merge"),ChoiceStore=function(){this.objects={}};merge(ChoiceStore.prototype,{isValid:function(value){return!/^\s*$/.test(value)},isEmpty:function(){return!Object.keys(this.objects).length},all:function(){var objects=this.objects;return Object.keys(objects).map(function(key){return objects[key]})},allNames:function(){return this.all().map(function(object){return object.name})},choiceNames:function(){return this._filteredNames(!1)},chosenNames:function(){return this._filteredNames(!0)},addChoice:function(object){return object.chosen=!1,this._add(object),this},addChosen:function(object){return object.chosen=!0,this._add(object),this},"delete":function(name){return delete this.objects[this._normalize(name)],this},fuzzy:function(value){var value=this._sanitize(value),query=/^\s*$/.test(value)?".*":value,regex=RegExp(query,"i"),objects=this.objects;return Object.keys(objects).reduce(function(memo,key){var object=objects[key];return regex.test(object.name)&&memo.push(object),memo},[])},_add:function(object){object.name=this._normalize(object.name),this.objects[object.name]=object},_filteredNames:function(chosen){return this.all().filter(function(object){return object.chosen===chosen}).map(function(object){return object.name})},_normalize:function(value){return String(value).toLowerCase().replace(/(^\s*|\s*$)/g,"")},_sanitize:function(value){return value.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&")}}),module.exports=ChoiceStore},{"../utils/merge":10}],8:[function(_dereq_,module){module.exports={on:function(name,callback,context){this._events=this._events||{};var events=this._events[name]||(this._events[name]=[]);return events.push({callback:callback,context:context||this}),this},off:function(name,callback,context){var events=this._events[name];return callback||context||delete this._events[name],this._events[name]=events.filter(function(event){return callback&&callback!==event.callback||context&&context!==event.context}),this},emit:function(name){if(!this._events)return this;var args=[].slice.call(arguments,1),events=this._events[name];return events&&events.forEach(function(event){event.callback.apply(event.context,args)}),this}}},{}],9:[function(_dereq_,module){module.exports=function(string,pattern){var regex=new RegExp("("+pattern+")","i");return string.replace(regex,"<b>$1</b>")}},{}],10:[function(_dereq_,module){module.exports=function(object){return[].slice.call(arguments,1).forEach(function(source){for(var prop in source)object[prop]=source[prop]}),object}},{}]},{},[6])(6)});